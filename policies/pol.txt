<if>
  <condition type:"AND">
    <custom_item>
      Ubuntu is installed
  <then>
    <report type:"PASSED">
      CIS_Ubuntu_18.04_LTS_Workstation_v2.0.1_L2.audit from CIS Ubuntu Linux 18.04 LTS Benchmark
    <if>
      <condition type:"OR">
        <custom_item>
          Check that /sys/firmware/efi exists
        <custom_item>
          Check that /boot/efi exists
      <then>
        <custom_item>
          1.1.1.8 Ensure mounting of FAT filesystems is limited - fstab
        <report type:"PASSED">
          1.1.1.8 Ensure mounting of FAT filesystems is limited - modprobe
        <report type:"PASSED">
          1.1.1.8 Ensure mounting of FAT filesystems is limited - lsmod
      <else>
        <custom_item>
          1.1.1.8 Ensure mounting of FAT filesystems is limited - fstab
        <custom_item>
          1.1.1.8 Ensure mounting of FAT filesystems is limited - modprobe
        <custom_item>
          1.1.1.8 Ensure mounting of FAT filesystems is limited - lsmod
    <custom_item>
      1.1.6 Ensure separate partition exists for /var
    <custom_item>
      1.1.7 Ensure separate partition exists for /var/tmp
    <custom_item>
      1.1.11 Ensure separate partition exists for /var/log
    <custom_item>
      1.1.12 Ensure separate partition exists for /var/log/audit
    <custom_item>
      1.1.13 Ensure separate partition exists for /home
    <if>
      <condition type:"AND">
        <custom_item>
          sysctemctl is-enabled autofs
      <then>
        <custom_item>
          1.1.22 Disable Automounting
      <else>
        <custom_item>
          1.1.22 Disable Automounting
    <custom_item>
      1.1.23 Disable USB Storage - modprobe
    <custom_item>
      1.1.23 Disable USB Storage - lsmod
    <custom_item>
      1.7.1.4 Ensure all AppArmor Profiles are enforcing - loaded
    <custom_item>
      1.7.1.4 Ensure all AppArmor Profiles are enforcing - complain
    <custom_item>
      1.7.1.4 Ensure all AppArmor Profiles are enforcing - unconfined
    <custom_item>
      2.2.4 Ensure CUPS is not enabled
    <custom_item>
      3.4.1 Ensure DCCP is disabled - modprobe
    <custom_item>
      3.4.1 Ensure DCCP is disabled - lsmod
    <custom_item>
      3.4.2 Ensure SCTP is disabled - modprobe
    <custom_item>
      3.4.2 Ensure SCTP is disabled - lsmod
    <custom_item>
      3.4.3 Ensure RDS is disabled - modprobe
    <custom_item>
      3.4.3 Ensure RDS is disabled - lsmod
    <custom_item>
      3.4.4 Ensure TIPC is disabled - modprobe
    <custom_item>
      3.4.4 Ensure TIPC is disabled - lsmod
    <custom_item>
      3.6 Ensure wireless interfaces are disabled
    <custom_item>
      3.7 Disable IPv6
    <custom_item>
      4.1.1.1 Ensure auditd is installed
    <custom_item>
      4.1.1.2 Ensure auditd service is enabled
    <custom_item>
      4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled
    <custom_item>
      4.1.1.4 Ensure audit_backlog_limit is sufficient
    <custom_item>
      4.1.2.1 Ensure audit log storage size is configured
    <custom_item>
      4.1.2.2 Ensure audit logs are not automatically deleted
    <custom_item>
      4.1.2.3 Ensure system is disabled when audit logs are full - 'space_left_action = email'
    <custom_item>
      4.1.2.3 Ensure system is disabled when audit logs are full - 'action_mail_acct = root'
    <custom_item>
      4.1.2.3 Ensure system is disabled when audit logs are full - 'admin_space_left_action = halt'
    <custom_item>
      4.1.3 Ensure events that modify date and time information are collected - auditctl adjtimex (32-bit)
    <custom_item>
      4.1.3 Ensure events that modify date and time information are collected - adjtimex (32-bit)
    <custom_item>
      4.1.3 Ensure events that modify date and time information are collected - auditctl clock_settime (32-bit)
    <custom_item>
      4.1.3 Ensure events that modify date and time information are collected - clock_settime (32-bit)
    <custom_item>
      4.1.3 Ensure events that modify date and time information are collected - auditctl /etc/localtime
    <custom_item>
      4.1.3 Ensure events that modify date and time information are collected - /etc/localtime
    <if>
      <condition type:"AND">
        <custom_item>
          OS is 64 bit
      <then>
        <custom_item>
          4.1.3 Ensure events that modify date and time information are collected - auditctl adjtimex (64-bit)
        <custom_item>
          4.1.3 Ensure events that modify date and time information are collected - auditctl clock_settime (64-bit)
        <custom_item>
          4.1.3 Ensure events that modify date and time information are collected - adjtimex (64-bit)
        <custom_item>
          4.1.3 Ensure events that modify date and time information are collected - clock_settime (64-bit)
      <else>
        <report type:"PASSED">
          4.1.3 Ensure events that modify date and time information are collected - adjtimex (64-bit)
        <report type:"PASSED">
          4.1.3 Ensure events that modify date and time information are collected - auditctl clock_settime (64-bit)
        <report type:"PASSED">
          4.1.3 Ensure events that modify date and time information are collected - auditctl adjtimex (64-bit)
        <report type:"PASSED">
          4.1.3 Ensure events that modify date and time information are collected - clock_settime (64-bit)
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - /etc/group
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - auditctl /etc/group
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - /etc/passwd
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - auditctl /etc/passwd
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - /etc/gshadow
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - auditctl /etc/gshadow
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - /etc/shadow
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - auditctl /etc/shadow
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - /etc/security/opasswd
    <custom_item>
      4.1.4 Ensure events that modify user/group information are collected - auditctl /etc/security/opasswd
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - sethostname (32-bit)
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - auditctl sethostname (32-bit)
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - issue
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - auditctl issue
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - issue.net
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - auditctl issue.net
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - /etc/hosts
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - auditctl hosts
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - /etc/network
    <custom_item>
      4.1.5 Ensure events that modify the system's network environment are collected - auditctl network
    <if>
      <condition type:"AND">
        <custom_item>
          OS is 64 bit
      <then>
        <custom_item>
          4.1.5 Ensure events that modify the system's network environment are collected - sethostname (64-bit)
        <custom_item>
          4.1.5 Ensure events that modify the system's network environment are collected - auditctl sethostname (64-bit)
      <else>
        <report type:"PASSED">
          4.1.5 Ensure events that modify the system's network environment are collected - sethostname (64-bit)
        <report type:"PASSED">
          4.1.5 Ensure events that modify the system's network environment are collected - auditctl sethostname (64-bit)
    <custom_item>
      4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - /etc/apparmor/
    <custom_item>
      4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - auditctl /etc/apparmor/
    <custom_item>
      4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - /etc/apparmor.d/
    <custom_item>
      4.1.6 Ensure events that modify the system's Mandatory Access Controls are collected - auditctl /etc/apparmor.d/
    <custom_item>
      4.1.7 Ensure login and logout events are collected - /var/log/lastlog
    <custom_item>
      4.1.7 Ensure login and logout events are collected - auditctl /var/log/lastlog
    <custom_item>
      4.1.7 Ensure login and logout events are collected - /var/log/faillog
    <custom_item>
      4.1.7 Ensure login and logout events are collected - auditctl /var/log/faillog
    <custom_item>
      4.1.7 Ensure login and logout events are collected - /var/log/tallylog
    <custom_item>
      4.1.7 Ensure login and logout events are collected - auditctl /var/log/tallylog
    <custom_item>
      4.1.8 Ensure session initiation information is collected - utmp
    <custom_item>
      4.1.8 Ensure session initiation information is collected - auditctl utmp
    <custom_item>
      4.1.8 Ensure session initiation information is collected - wtmp
    <custom_item>
      4.1.8 Ensure session initiation information is collected - auditctl wtmp
    <custom_item>
      4.1.8 Ensure session initiation information is collected - btmp
    <custom_item>
      4.1.8 Ensure session initiation information is collected - auditctl btmp
    <custom_item>
      4.1.9 Ensure discretionary access control permission modification events are collected - chmod/fchmod/fchmodat
    <custom_item>
      4.1.9 Ensure discretionary access control permission modification events are collected - auditctl chmod/fchmod/fchmodat
    <custom_item>
      4.1.9 Ensure discretionary access control permission modification events are collected - chown/fchown/fchownat/lchown
    <custom_item>
      4.1.9 Ensure discretionary access control permission modification events are collected - auditctl chown/fchown/fchownat/lchown
    <custom_item>
      4.1.9 Ensure discretionary access control permission modification events are collected - setxattr/lsetxattr/fsetxattr/removexattr
    <custom_item>
      4.1.9 Ensure discretionary access control permission modification events are collected - auditctl setxattr/lsetxattr/fsetxattr/removexattr
    <if>
      <condition type:"AND">
        <custom_item>
          OS is 64 bit
      <then>
        <custom_item>
          4.1.9 Ensure discretionary access control permission modification events are collected - chmod/fchmod/fchmodat (64-bit)
        <custom_item>
          4.1.9 Ensure discretionary access control permission modification events are collected - auditctl chmod/fchmod/fchmodat (64-bit)
        <custom_item>
          4.1.9 Ensure discretionary access control permission modification events are collected - chown/fchown/fchownat/lchown (64-bit)
        <custom_item>
          4.1.9 Ensure discretionary access control permission modification events are collected - auditctl chown/fchown/fchownat/lchown (64-bit)
        <custom_item>
          4.1.9 Ensure discretionary access control permission modification events are collected - xattr (64-bit)
        <custom_item>
          4.1.9 Ensure discretionary access control permission modification events are collected - auditctl xattr (64-bit)
      <else>
        <report type:"PASSED">
          4.1.9 Ensure discretionary access control permission modification events are collected - chmod/fchmod/fchmodat (64-bit)
        <report type:"PASSED">
          4.1.9 Ensure discretionary access control permission modification events are collected - auditctl chmod/fchmod/fchmodat (64-bit)
        <report type:"PASSED">
          4.1.9 Ensure discretionary access control permission modification events are collected - chown/fchown/fchownat/lchown (64-bit)
        <report type:"PASSED">
          4.1.9 Ensure discretionary access control permission modification events are collected - auditctl chown/fchown/fchownat/lchown (64-bit)
        <report type:"PASSED">
          4.1.9 Ensure discretionary access control permission modification events are collected - xattr (64-bit)
        <report type:"PASSED">
          4.1.9 Ensure discretionary access control permission modification events are collected - auditctl xattr (64-bit)
    <custom_item>
      4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - EACCES
    <custom_item>
      4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - auditctl EACCES
    <custom_item>
      4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - EPERM
    <custom_item>
      4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - auditctl EPERM
    <if>
      <condition type:"AND">
        <custom_item>
          OS is 64 bit
      <then>
        <custom_item>
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - EACCES (64-bit)
        <custom_item>
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - auditctl EACCES (64-bit)
        <custom_item>
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - EPERM (64-bit)
        <custom_item>
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - auditctl EPERM (64-bit)
      <else>
        <report type:"PASSED">
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - EACCES (64-bit)
        <report type:"PASSED">
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - auditctl EACCES (64-bit)
        <report type:"PASSED">
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - EPERM (64-bit)
        <report type:"PASSED">
          4.1.10 Ensure unsuccessful unauthorized file access attempts are collected - auditctl EPERM (64-bit)
    <custom_item>
      4.1.11 Ensure use of privileged commands is collected
    <custom_item>
      4.1.12 Ensure successful file system mounts are collected - 32-bit
    <custom_item>
      4.1.12 Ensure successful file system mounts are collected - auditctl (32-bit)
    <if>
      <condition type:"AND">
        <custom_item>
          OS is 64 bit
      <then>
        <custom_item>
          4.1.12 Ensure successful file system mounts are collected - 64-bit
        <custom_item>
          4.1.12 Ensure successful file system mounts are collected - auditctl (64-bit)
      <else>
        <report type:"PASSED">
          4.1.12 Ensure successful file system mounts are collected - 64-bit
        <report type:"PASSED">
          4.1.12 Ensure successful file system mounts are collected - auditctl (64-bit)
    <custom_item>
      4.1.13 Ensure file deletion events by users are collected - 32-bit
    <custom_item>
      4.1.13 Ensure file deletion events by users are collected - auditctl (32-bit)
    <if>
      <condition type:"AND">
        <custom_item>
          OS is 64 bit
      <then>
        <custom_item>
          4.1.13 Ensure file deletion events by users are collected - 64-bit
        <custom_item>
          4.1.13 Ensure file deletion events by users are collected - auditctl (64-bit)
      <else>
        <report type:"PASSED">
          4.1.13 Ensure file deletion events by users are collected - 64-bit
        <report type:"PASSED">
          4.1.13 Ensure file deletion events by users are collected - auditctl (64-bit)
    <custom_item>
      4.1.14 Ensure changes to system administration scope (sudoers) is collected - sudoers
    <custom_item>
      4.1.14 Ensure changes to system administration scope (sudoers) is collected - auditctl sudoers
    <custom_item>
      4.1.14 Ensure changes to system administration scope (sudoers) is collected - sudoers.d
    <custom_item>
      4.1.14 Ensure changes to system administration scope (sudoers) is collected - auditctl sudoers.d
    <custom_item>
      4.1.15 Ensure system administrator actions (sudolog) are collected
    <custom_item>
      4.1.15 Ensure system administrator actions (sudolog) are collected - auditctl
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - insmod
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - auditctl insmod
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - rmmod
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - auditctl rmmod
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - modprobe
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - auditctl modprobe
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - init_module/delete_module (32-bit)
    <custom_item>
      4.1.16 Ensure kernel module loading and unloading is collected - auditctl init_module/delete_module (32-bit)
    <if>
      <condition type:"AND">
        <custom_item>
          OS is 64 bit
      <then>
        <custom_item>
          4.1.16 Ensure kernel module loading and unloading is collected - init_module/delete_module  (64-bit)
        <custom_item>
          4.1.16 Ensure kernel module loading and unloading is collected - auditctl init_module/delete_module (64-bit)
      <else>
        <report type:"PASSED">
          4.1.16 Ensure kernel module loading and unloading is collected - init_module/delete_module  (64-bit)
        <report type:"PASSED">
          4.1.16 Ensure kernel module loading and unloading is collected - auditctl init_module/delete_module (64-bit)
    <custom_item>
      4.1.17 Ensure the audit configuration is immutable
    <custom_item>
      5.2.21 Ensure SSH AllowTcpForwarding is disabled
    <report type:"WARNING">
      6.1.1 Audit system file permissions
  <else>
    <report type:"WARNING">
      CIS_Ubuntu_18.04_LTS_Workstation_v2.0.1_L2.audit from CIS Ubuntu Linux 18.04 LTS Benchmark

